<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Plato Items</title>        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap4.min.css">        
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js"></script>        
        <style type="text/css">
        
            html
            {
                margin:0;
                padding:0;
                height:100%;
            }
            
            body
            {
                margin:0;
                padding:0;
                height:100%;
                color:#343A40;
            }
            
            h1
            {
                margin:0;
                padding:0;
                font-size:40pt;
            }
            
            p
            {
                font-size:12pt;
            }
            
            table
            {
                width:100% !important;
            }
            
            tr
            {
                padding:0;
            }
            
            th
            {
                padding:3px !important;
                text-align:center;
            }
            
            td
            {
                padding:3px !important;
                text-align:center;
                vertical-align:middle !important;
            }          
            
            tbody tr:hover td
            {
                background-color:#F2F2F2;
            }
            
            input,
            select
            {
                font-size:11pt !important;
            }

            input:focus,
            input:hover,
            select:focus,
            select:hover
            {
                border-color:transparent !important;
                box-shadow:inset 0 1px 1px #F2F2F2, 0 0 8px #343A40 !important;
            }
            
            .pagination > li > a
            {
                color:#343A40 !important;
                padding-left:8px !important;
                padding-right:8px !important;
            }

            .pagination > li.active > a
            {
                color:#ffffff !important;
                background-color:#343A40 !important;
                border:1px solid #DEE2E6 !important;
            }

            .pagination > li > a:focus,
            .pagination > li > span:focus,
            .pagination > li > a:hover,
            .pagination > li > span:hover
            {
                box-shadow:none !important;
                background-color:#FFFFFF;
                border:1px solid #DEE2E6 !important;
            }
            
            #myloading
            {
                display:block;
                padding-top:0px;
            }
            
            #myloading img
            {
                width:100px;
            }
            
            #myloaded
            {
                display:none;
                padding-top:30px;
                padding-bottom:60px;
            }
            
            #items_filter input,
            #items_filter select
            {
                width:200px !important;
                margin:0 !important;
            }
            
            #items_filter input
            {
                padding-left:29px;
                text-indent:0 !important;
                background:url(https://platoitems.github.io/docs/assets/images/search.png) no-repeat 8px center;
                background-color:#FFFFFF !important;
                background-size:14px;
                -webkit-background-size:14px;
                -moz-background-size:14px;
                -o-background-size:14px;
            }
            
            /*
            #items_filter select
            {
                padding-left:29px;
                text-indent:0 !important;
                background:url(https://platoitems.github.io/docs/assets/images/category.png) no-repeat 8px center;
                background-color:#FFFFFF !important;
                background-size:14px;
                -webkit-background-size:14px;
                -moz-background-size:14px;
                -o-background-size:14px;
            }
            */
            
            #items_filter input::-webkit-search-cancel-button
            {
                
            }
            
        </style>
        <script type="text/javascript">

            //////////////////////////////////////////////////
        
            $( document ).ready( on_ready );
            
            //////////////////////////////////////////////////
            
            function on_ready ( ) {
            
                var table = $( '#items' ).DataTable
                ( {
                    'search'       : { 'search' : decodeURI( location.hash.substr( 1 ) ) },
                    'order'        : [ ],
                    'initComplete' : on_table, // function ( ) { setTimeout( on_table.bind( this ), 1000 ) },
                    'language'     :
                    {
                        'lengthMenu'        : '_MENU_ entries',
                        'info'              : '_START_ to _END_ of _TOTAL_ entries',
                        'infoFiltered'      : '(_MAX_ total entries)',
                        'infoEmpty'         : '0 to 0 of 0 entries',
                        'search'            : '',
                        'searchPlaceholder' : '',
                        'paginate'          : { 'previous' : '&lt;', 'next' : '&gt;' },
                    },
                    'columnDefs' :
                    [
                        { 'targets' : [ 4, 5, 6 ], 'visible' : false },
                    ],
                } );

                table.on( 'search.dt', function ( ) { 

                    history.pushState( null, null, '#' + table.search( ) );
                    
                } );
                
            }
            
            //////////////////////////////////////////////////
            
            function on_table ( settings, json ) {
                
                var api = this.api( );

                            $( '<br>'                                                                                  ).prependTo( '#items_filter' );
                var label = $( '<label></label>'                                                                       ).prependTo( '#items_filter' );
                var menu  = $( '<select class="custom-select custom-select-sm form-control form-control-sm"></select>' ).appendTo ( label           );
                            $( '<option value="=">All</option>'                                                        ).appendTo ( menu            );
                            $( '<option disabled>----------</option>'                                                  ).appendTo ( menu            );
                            $( '<option value="4=1">New</option>'                                                      ).appendTo ( menu            );
                            $( '<option value="6=1">Rare</option>'                                                     ).appendTo ( menu            );
                            $( '<option value="5=1">Tournament</option>'                                               ).appendTo ( menu            );
                            $( '<option disabled>----------</option>'                                                  ).appendTo ( menu            );

                api.column( 0 ).data( ).unique( ).sort( ).each( function ( type ) {
                
                    menu.append( '<option value="0=' + type + '">' + type + '</option>' );
                    
                } );

                menu.on( 'change', function ( ) {
                
                    var val = $.fn.dataTable.util.escapeRegex( $( this ).val( ) ).split( '=', 2 );

                    api.columns(        ).search( '' );
                    api.column ( val[0] ).search( val[0] ? '^' + val[1] + '$' : '', true, false ).draw( );
                    
                } );
                
                $( this ).show( );

                $( '#myloading' ).css( 'display', 'none'  );
                $( '#myloaded'  ).css( 'display', 'block' );

            }
            
            //////////////////////////////////////////////////
            
            function mymodal_open ( url ) {
                
                $( '#myimage' ).attr ( 'src', ''  );
                $( '#myimage' ).attr ( 'src', url );
                $( '#mymodal' ).modal( 'show'     );
                
            }
            
            //////////////////////////////////////////////////
            
        </script>
    </head>
    <body oncontextmenu="return false;">
        <div id="myloading" class="container-fluid">
            <div class="row">
                <div class="col vh-100 d-flex justify-content-center align-items-center">
                    <img src="https://platoitems.github.io/docs/assets/images/loading.gif" />
                </div>
            </div>
        </div>
        <div id="myloaded" class="container-fluid">
            <div class="row">
                <div class="col text-center">
                    <h1>Plato Items</h1>
                    <p><b>Last Updated:</b> {{ page.datetime }}</p>
                </div>
            </div>
            <div class="row">
                <div class="col">
{{ content }}
                </div>
            </div>
        </div>
        <div id="mymodal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-body text-center">
                        <img id="myimage" class="img-fluid" src="" />
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
